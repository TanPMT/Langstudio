import{_ as B}from"./LogoDark.vue_vue_type_script_setup_true_lang-CCGflCWU.js";import{F as P}from"./vee-validate-GsyDsh7C.js";import{g as $,y as k,J as o,o as d,u as m,b as n,a as e,w as a,X as b,e as v,t as w,d as g,au as j,n as q,E as A,I as N,F as I,c as R,ae as z,V as h,f as y,aj as V,a9 as D}from"./index-CKNFkSVT.js";const G="http://localhost:5028/api/Auth",J={post:O};async function O(u,l){const t=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),p=t.headers.get("content-type");if(!t.ok){const _=await t.text();throw new Error(_)}return p&&p.includes("application/json")?await t.json():await t.text()}const U=$({id:"auth-forgot",actions:{async sendpass(u){try{return await J.post(`${G}/forgot-password`,{email:u})}catch(l){throw console.error("Gửi yêu cầu quên mật khẩu thất bại:",l),l}}}}),H={key:0},L={key:1},W={key:2},X={class:"d-sm-flex align-center mt-2 mb-7 mb-sm-0"},K={class:"ml-auto"},M={key:0,class:"mt-2"},Q={class:"mt-5 text-right"},Y=k({__name:"AuthForgot",setup(u){o(!1);const l=o(!1);o(!1);const t=o("thai25800852@gmail.com"),p=o([c=>!!c||"E-mail is required",c=>/.+@.+\..+/.test(c)||"E-mail must be valid"]),_=U(),r=o(0),f=o(null),i=o(!1);function C(){if(!t.value||!/.+@.+\..+/.test(t.value)){alert("Vui lòng nhập email hợp lệ trước khi gửi mã");return}i.value=!0,setTimeout(()=>{i.value=!1,S(),alert(`Đã gửi mã xác nhận đến ${t.value}`)},1e3)}function S(){r.value=60,f.value&&clearInterval(f.value),f.value=setInterval(()=>{r.value>0?r.value--:clearInterval(f.value)},1e3)}async function F(){try{console.log("Sending Resend-Password request:",{email:t.value}),await _.sendpass(t.value),alert(`Đã gửi mật khẩu đến gmail ${t.value}`)}catch{alert("Gửi mật khẩu đến gmail thất bại!")}finally{i.value=!1}}return(c,s)=>(d(),m(I,null,[s[4]||(s[4]=n("h5",{class:"text-h5 text-center my-4 mb-8"},"Forgot Password",-1)),e(A(P),{onSubmit:F,class:"mt-7 loginForm"},{default:a(({errors:x,isSubmitting:E})=>[e(b,{modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=T=>t.value=T),rules:p.value,label:"Email Address",class:"mt-4 mb-8",required:"",density:"comfortable","hide-details":"auto",variant:"outlined",color:"primary"},null,8,["modelValue","rules"]),e(b,{label:"Code",required:"",density:"comfortable",variant:"outlined",color:"primary","hide-details":"auto",class:"mt-4 mb-8"},{append:a(()=>[e(v,{color:"primary",class:"mt-2",size:"small",variant:"text",disabled:r.value>0||i.value,onClick:C},{default:a(()=>[r.value===0&&!i.value?(d(),m("span",H,"Send Code")):i.value?(d(),m("span",L,"Sending...")):(d(),m("span",W,w(r.value)+"s",1))]),_:1},8,["disabled"])]),_:1}),n("div",X,[n("div",K,[e(v,{variant:"plain",to:"/login1",class:"text-primary text-decoration-none"},{default:a(()=>s[1]||(s[1]=[g("Login Page")])),_:1})])]),e(v,{color:"secondary",loading:E,block:"",class:"mt-2",variant:"flat",size:"large",disabled:l.value,type:"submit"},{default:a(()=>s[2]||(s[2]=[g(" Send new password")])),_:2},1032,["loading","disabled"]),x.apiError?(d(),m("div",M,[e(j,{color:"error"},{default:a(()=>[g(w(x.apiError),1)]),_:2},1024)])):q("",!0)]),_:1}),n("div",Q,[e(N),e(v,{variant:"plain",to:"/register",class:"mt-2 text-capitalize mr-n2"},{default:a(()=>s[3]||(s[3]=[g("Don't Have an account?")])),_:1})])],64))}}),Z={class:"pa-7 pa-sm-12"},se=k({__name:"FogotPage",setup(u){return(l,t)=>(d(),R(h,{class:"h-screen","no-gutters":""},{default:a(()=>[e(y,{cols:"12",class:"d-flex align-center bg-lightprimary"},{default:a(()=>[e(z,null,{default:a(()=>[n("div",Z,[e(h,{justify:"center"},{default:a(()=>[e(y,{cols:"12",lg:"10",xl:"6",md:"7"},{default:a(()=>[e(V,{elevation:"0",class:"loginBox"},{default:a(()=>[e(V,{variant:"outlined"},{default:a(()=>[e(D,{class:"pa-9"},{default:a(()=>[e(h,null,{default:a(()=>[e(y,{cols:"12",class:"text-center"},{default:a(()=>[e(B),t[0]||(t[0]=n("h2",{class:"text-secondary text-h2 mt-8"},"Reset Password",-1)),t[1]||(t[1]=n("h4",{class:"text-disabled text-h4 mt-3"},"Send new password to your e-mail",-1))]),_:1})]),_:1}),e(Y)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}))}});export{se as default};
