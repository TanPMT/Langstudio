import{_ as I}from"./LogoDark.vue_vue_type_script_setup_true_lang-CCGflCWU.js";import{y as S,J as s,o as p,u as y,b as i,a,w as o,V as w,f,X as m,e as V,t as N,at as O,d as T,aH as z,I as J,F as D,c as G,ae as H,aj as E,a9 as X}from"./index-CKNFkSVT.js";const Y={key:0},K={key:1},M={key:2},Q={class:"d-sm-inline-flex align-center mt-2 mb-7 mb-sm-0 font-weight-bold"},W={class:"mt-5 text-right"},Z=S({__name:"AuthRegister",setup($){const b=s(!1),n=s(!1),v=s(""),x=s(""),d=s(""),j=s(),k=s(""),_=s(""),c=s(!1),u=s(0),g=s(null),A=s([l=>!!l||"Password is required",l=>l&&l.length<=30||"Password must be less than 30 characters"]),L=s([l=>!!l||"E-mail is required",l=>/.+@.+\..+/.test(l)||"E-mail must be valid"]);async function R(){await F(d,x)}function C(l){return l&&typeof l=="object"&&"value"in l?l.value:l}async function U(){if(!d.value||!/.+@.+\..+/.test(d.value)){alert("Vui lòng nhập email hợp lệ trước khi gửi mã");return}c.value=!0,await B(d.value,v.value),await setTimeout(()=>{c.value=!1,q()},1e3)}function q(){u.value=60,g.value&&clearInterval(g.value),g.value=setInterval(()=>{u.value>0?u.value--:clearInterval(g.value)},1e3)}async function B(l,t){try{if(!l||!t)throw new Error("Email và password là bắt buộc");const e=await fetch("http://localhost:5028/api/Auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l,password:t})});if(!e.ok){const h=await e.text();throw new Error(h||"Lỗi server không xác định")}const r=await e.json();return console.log("Đã gửi code thành công:",r),alert(`Đã gửi mã xác nhận đến ${l}`),r}catch(e){throw console.error("Lỗi gửi code:",e.message),e.message.includes("Email already exists")?alert("Tài khoản đã tồn tại"):alert(`Lỗi gửi code: ${e.message}`),e}}async function F(l,t){try{if(!l||!v||!t)throw new Error("Email , password và code là bắt buộc");const e=await fetch("http://localhost:5028/api/Auth/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:C(l),code:C(t)})});if(!e.ok){const P=await e.text();throw new Error(P||"Lỗi server không xác định")}let r;const h=e.headers.get("Content-Type");return h&&h.includes("application/json")?r=await e.json():r=await e.text(),console.log("Tạo tài khoản thành công:",r),alert("Tài khoản đã được tạo thành công!"),window.location.href="/login1",r}catch(e){throw console.error("Lỗi tạo tài khoản:",e.message),alert(`Lỗi tạo tài khoản: ${e.message}`),e}}return(l,t)=>(p(),y(D,null,[t[11]||(t[11]=i("h5",{class:"text-h5 text-center my-4 mb-8"},"Sign up",-1)),a(z,{ref_key:"Regform",ref:j,"lazy-validation":"",action:"/dashboards/analytical",class:"mt-7 loginForm"},{default:o(()=>[a(w,null,{default:o(()=>[a(f,{cols:"12",sm:"6"},{default:o(()=>[a(m,{modelValue:k.value,"onUpdate:modelValue":t[0]||(t[0]=e=>k.value=e),density:"comfortable","hide-details":"auto",variant:"outlined",color:"primary",label:"Firstname"},null,8,["modelValue"])]),_:1}),a(f,{cols:"12",sm:"6"},{default:o(()=>[a(m,{modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=e=>_.value=e),density:"comfortable","hide-details":"auto",variant:"outlined",color:"primary",label:"Lastname"},null,8,["modelValue"])]),_:1})]),_:1}),a(m,{modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=e=>d.value=e),rules:L.value,label:"Email Address",class:"mt-4 mb-4",required:"",density:"comfortable","hide-details":"auto",variant:"outlined",color:"primary"},null,8,["modelValue","rules"]),a(m,{modelValue:v.value,"onUpdate:modelValue":t[3]||(t[3]=e=>v.value=e),rules:A.value,label:"Password",required:"",density:"comfortable",variant:"outlined",color:"primary","hide-details":"auto","append-icon":n.value?"$eye":"$eyeOff",type:n.value?"text":"password","onClick:append":t[4]||(t[4]=e=>n.value=!n.value),class:"pwdInput"},null,8,["modelValue","rules","append-icon","type"]),a(m,{modelValue:x.value,"onUpdate:modelValue":t[5]||(t[5]=e=>x.value=e),label:"Code",required:"",density:"comfortable",variant:"outlined",color:"primary","hide-details":"auto",class:"mt-4 mb-8"},{append:o(()=>[a(V,{color:"primary",class:"mt-2",size:"small",variant:"text",disabled:u.value>0||c.value,onClick:U},{default:o(()=>[u.value===0&&!c.value?(p(),y("span",Y,"Send Code")):c.value?(p(),y("span",K,"Sending...")):(p(),y("span",M,N(u.value)+"s",1))]),_:1},8,["disabled"])]),_:1},8,["modelValue"]),i("div",Q,[a(O,{modelValue:b.value,"onUpdate:modelValue":t[6]||(t[6]=e=>b.value=e),rules:[e=>!!e||"You must agree to continue!"],label:"Agree with?",required:"",color:"primary",class:"ms-n2","hide-details":""},null,8,["modelValue","rules"]),t[8]||(t[8]=i("a",{href:"#",class:"ml-1 text-lightText"},"Terms and Condition",-1))]),a(V,{color:"secondary",block:"",class:"mt-2",variant:"flat",size:"large",onClick:t[7]||(t[7]=e=>R())},{default:o(()=>t[9]||(t[9]=[T("Sign Up")])),_:1})]),_:1},512),i("div",W,[a(J),a(V,{variant:"plain",to:"/login1",class:"mt-2 text-capitalize mr-n2"},{default:o(()=>t[10]||(t[10]=[T("Already have an account?")])),_:1})])],64))}}),ee={class:"pa-7 pa-sm-12"},le=S({__name:"RegisterPage",setup($){return(b,n)=>(p(),G(w,{class:"h-screen","no-gutters":""},{default:o(()=>[a(f,{cols:"12",class:"d-flex align-center bg-lightprimary"},{default:o(()=>[a(H,null,{default:o(()=>[i("div",ee,[a(w,{justify:"center"},{default:o(()=>[a(f,{cols:"12",lg:"10",xl:"6",md:"7"},{default:o(()=>[a(E,{elevation:"0",class:"loginBox"},{default:o(()=>[a(E,{variant:"outlined"},{default:o(()=>[a(X,{class:"pa-9"},{default:o(()=>[a(w,null,{default:o(()=>[a(f,{cols:"12",class:"text-center"},{default:o(()=>[a(I),n[0]||(n[0]=i("h2",{class:"text-secondary text-h2 mt-8"},"Sign up",-1)),n[1]||(n[1]=i("h4",{class:"text-disabled text-h4 mt-3"},"Enter credentials to continue",-1))]),_:1})]),_:1}),a(Z)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}))}});export{le as default};
